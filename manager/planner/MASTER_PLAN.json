{
  "level": 1,
  "title": "Master Plan: Intelligent Control SaaS",
  "metadata": {
    "status": "active",
    "type": "plan",
    "id": "master_plan.saas",
    "owner": "product-manager",
    "priority": "critical",
    "last_checked": "2026-01-23T15:14:25+01:00"
  },
  "content": "This document serves as the central strategic plan for the **Intelligent Control & Analysis Platform**. It is a dual-engine AI system functioning as both a **Business Analyst** and an **Autonomous Operator** for SMBs and industrial clients. It combines LLM reasoning (Analysis) with RL control (Optimization).",
  "children": [
    {
      "level": 2,
      "title": "Executive Summary",
      "metadata": {
        "status": "done",
        "type": "context",
        "id": "product.saas.summary",
        "last_checked": "2026-01-23T13:47:07+01:00"
      },
      "content": "**The Vision**: Transform data into decision. The platform allows clients to \"chat with data\" and optimize operations using a conversational interface backed by rigorous execution engines.\n-   **Analyst**: \"Why is this happening?\" -> Code Interpreter analysis.\n-   **Controller**: \"Optimize for efficiency.\" -> RL Agent execution.\n\n**Value Propositions**\n1.  **Retail/SMBs (The Agentic Analyst)**: Democratized Data Science. Instant answers to colloquial questions without a data team.\n2.  **Logistics (Inventory Auto-Pilot)**: Cash flow optimization. Automated reordering using RL agents to solve the Newsvendor problem (minimize holding costs vs. prevent stockouts).",
      "children": []
    },
    {
      "level": 2,
      "title": "Technical Architecture",
      "metadata": {
        "status": "active",
        "type": "plan",
        "id": "product.saas.arch",
        "last_checked": "2026-01-23T13:47:07+01:00"
      },
      "content": "The system separates Analytical Queries (Code Execution) from Control Tasks (Model Inference).",
      "children": [
        {
          "level": 3,
          "title": "Core Components",
          "metadata": {
            "status": "active",
            "type": "context",
            "id": "product.saas.arch.components",
            "last_checked": "2026-01-23T13:47:07+01:00"
          },
          "content": "",
          "children": [
            {
              "level": 4,
              "title": "Chatbot Assistant App",
              "metadata": {
                "status": "active",
                "type": "context",
                "id": "product.saas.arch.components.chatbot",
                "last_checked": "2026-01-23T19:47:31+01:00"
              },
              "content": "Serves as the primary interface for users, functioning simultaneously as a mechanism for interaction and a local data warehouse. It facilitates data collection and user intent capture.",
              "children": []
            },
            {
              "level": 4,
              "title": "Internal Ecosystem of AI-Assistants",
              "metadata": {
                "status": "active",
                "type": "context",
                "id": "product.saas.arch.components.ecosystem",
                "last_checked": "2026-01-23T19:47:31+01:00"
              },
              "content": "A background orchestration layer where multiple specialized AI agents collaborate. These agents are internal-only and handle specific sub-tasks to ensure seamless system operation.",
              "children": []
            },
            {
              "level": 4,
              "title": "Cloud Infrastructure (BigQuery & Compute)",
              "metadata": {
                "status": "active",
                "type": "context",
                "id": "product.saas.arch.components.cloud",
                "last_checked": "2026-01-23T19:47:31+01:00"
              },
              "content": "The scalable backbone of the platform. It includes **Google BigQuery** for massive data warehousing and **Google Cloud Compute** for performant processing, ensuring reliability and speed.",
              "children": []
            },
            {
              "level": 4,
              "title": "Internal Algorithms Repository",
              "metadata": {
                "status": "active",
                "type": "context",
                "id": "product.saas.arch.components.algorithms",
                "last_checked": "2026-01-23T19:47:31+01:00"
              },
              "content": "The central library of data processing and control algorithms. This leverages **Vertex AI** for advanced data science modeling and optimization tasks, representing the core intellectual property of the analysis engine.",
              "children": []
            }
          ]
        },
        {
          "level": 3,
          "title": "Information Flow",
          "metadata": {
            "status": "active",
            "type": "context",
            "id": "product.saas.arch.flow",
            "last_checked": "2026-01-23T13:47:07+01:00"
          },
          "content": "",
          "children": [
            {
              "level": 4,
              "title": "AI Assistant Orchestration",
              "metadata": {
                "status": "active",
                "type": "context",
                "id": "product.saas.arch.flow.orchestration",
                "last_checked": "2026-01-23T15:28:59+01:00"
              },
              "content": "User interaction begins with the Chatbot App, which forwards requests to the Orchestrator (Vertex AI).\n1.  **Intent Recognition**: The Orchestrator determines if the request is **Analysis** (informational) or **Control** (actionable).\n2.  **Routing**:\n    *   **Analysis**: Routed to Code Interpreter / Analyst Agent for data querying and visualization.\n    *   **Control**: Routed to Planner / RL Agent for optimization and decision making.\n3.  **Response**: Results are aggregated and returned to the Chatbot as natural language or UI components.",
              "children": []
            },
            {
              "level": 4,
              "title": "Control Loop",
              "metadata": {
                "status": "active",
                "type": "context",
                "id": "product.saas.arch.flow.control",
                "last_checked": "2026-01-23T15:28:59+01:00"
              },
              "content": "This high-frequency loop handles the autonomous optimization system:\n1.  **Telemetry Ingest**: Raw data streams from the Client App/Warehouse are ingested into BigQuery.\n2.  **State Estimation**: Processing algorithms convert raw telemetry into state vectors ($s_t$) suitable for model input.\n3.  **Decision**: The Policy network ($\\pi$) or Planer selects the optimal action ($a_t$) based on the current state.\n4.  **Execution & Feedback**: The action is sent to the Controller for execution, and the outcome is recorded for offline re-training and refinement.",
              "children": []
            },
            {
              "level": 4,
              "title": "Human-AI Interaction",
              "metadata": {
                "status": "active",
                "type": "context",
                "id": "product.saas.arch.flow.human_ai",
                "last_checked": "2026-01-23T19:51:07+01:00"
              },
              "content": "Defines the protocols for how humans interact with the AI agents.",
              "children": [
                {
                  "level": 5,
                  "title": "Developer-AI Interaction",
                  "metadata": {
                    "status": "active",
                    "type": "protocol",
                    "id": "product.saas.arch.flow.human_ai.developer",
                    "last_checked": "2026-01-23T19:51:07+01:00"
                  },
                  "content": "Protocol for developers to configure, train, and debug agents. Involves direct access to internal logs, model weights, and the 'Analysis Sandbox' for safe code testing.",
                  "children": []
                },
                {
                  "level": 5,
                  "title": "Client-AI Interaction",
                  "metadata": {
                    "status": "active",
                    "type": "protocol",
                    "id": "product.saas.arch.flow.human_ai.client",
                    "last_checked": "2026-01-23T19:51:07+01:00"
                  },
                  "content": "Protocol for end-users. Restricted to natural language via the Chatbot App. No direct code execution allowed. Intent is parsed by the Orchestrator.",
                  "children": []
                }
              ]
            },
            {
              "level": 4,
              "title": "AI-Tools Protocols",
              "metadata": {
                "status": "active",
                "type": "protocol",
                "id": "product.saas.arch.flow.tools",
                "last_checked": "2026-01-23T19:51:07+01:00"
              },
              "content": "Protocols for how AI agents utilize external software and APIs. Adheres to the **Model Context Protocol (MCP)** to standardize tool definition, discovery, and execution.",
              "children": []
            }
          ]
        },
        {
          "level": 3,
          "title": "Knowledge Bases",
          "metadata": {
            "status": "active",
            "type": "context",
            "id": "product.saas.arch.knowledge",
            "last_checked": "2026-01-23T20:00:00+01:00"
          },
          "content": "Repository resources categorized by their function.",
          "children": [
            {
              "level": 4,
              "title": "Agentic",
              "metadata": {
                "status": "active",
                "type": "context",
                "id": "product.saas.arch.knowledge.agentic",
                "last_checked": "2026-01-23T20:00:00+01:00"
              },
              "content": "- [MANAGER_AGENT](MANAGER_AGENT.md)\n- [CLEANER_AGENT](../cleaner/CLEANER_AGENT.md)\n- [REACT_ASSISTANT](../../AI_AGENTS/specialists/REACT_ASSISTANT.md)\n- [RECSYS_AGENT](../../AI_AGENTS/specialists/RECSYS_AGENT.md)\n- [CONTROL_AGENT](../../AI_AGENTS/specialists/CONTROL_AGENT.md)\n- [UI_DESIG_ASSISTANT](../../AI_AGENTS/specialists/UI_DESIG_ASSISTANT.md)\n- [LINEARIZE_AGENT](../../AI_AGENTS/specialists/LINEARIZE_AGENT.md)\n- [MC_AGENT](../../AI_AGENTS/specialists/MC_AGENT.md)",
              "children": []
            },
            {
              "level": 4,
              "title": "Knowledge",
              "metadata": {
                "status": "active",
                "type": "context",
                "id": "product.saas.arch.knowledge.general",
                "last_checked": "2026-01-23T20:00:00+01:00"
              },
              "content": "- [README](../../README.md)\n- [MD_REPRESENTATION_CONVENTIONS](../../MD_REPRESENTATION_CONVENTIONS.md)\n- [AGENTS](../../AGENTS.md)\n- [AGENTS_LOG](../../AGENTS_LOG.md)\n- [DAG_Example](../../language/example/DAG_Example.md)",
              "children": []
            }
          ]
        }
      ]
    },
    {
      "level": 2,
      "title": "Implementation Roadmap",
      "metadata": {
        "status": "active",
        "type": "plan",
        "id": "product.saas.roadmap",
        "last_checked": "2026-01-23T21:44:23+01:00"
      },
      "content": "This roadmap strips away enterprise complexity to focus on the core value proposition: a local app that acts as a data hub and a chat interface, connected to powerful cloud agents for execution.",
      "children": [
        {
          "level": 3,
          "title": "Phase 1: The Local Nexus (Client App)",
          "metadata": {
            "status": "todo",
            "type": "plan",
            "id": "product.saas.roadmap.phase1",
            "estimate": "4w",
            "last_checked": "2026-01-23T21:44:23+01:00"
          },
          "content": "**Objective**: Build the interface that serves as both the chatbot and the local data warehouse.",
          "children": [
            {
              "level": 4,
              "title": "Local Chat Interface",
              "metadata": {
                "status": "todo",
                "type": "task",
                "id": "product.saas.roadmap.phase1.chat_ui",
                "estimate": "2w",
                "last_checked": "2026-01-23T21:44:23+01:00"
              },
              "content": "- **Tech**: Electron (React) or Streamlit for a unified desktop feel.\n- **Features**:\n  - Chat window for natural language query.\n  - \"Upload Data\" button (CSV/Excel).\n  - Rendering engine for Tables and Charts returned by the cloud.",
              "children": []
            },
            {
              "level": 4,
              "title": "Local Data Warehouse Engine",
              "metadata": {
                "status": "todo",
                "type": "task",
                "id": "product.saas.roadmap.phase1.local_db",
                "blocked_by": [
                  "product.saas.roadmap.phase1.chat_ui"
                ],
                "estimate": "2w",
                "last_checked": "2026-01-23T21:44:23+01:00"
              },
              "content": "- **Tech**: SQLite or DuckDB (embedded OLAP).\n- **Function**:\n  - Ingest user files into a structured SQL format locally.\n  - Allow the app to query itself for basic stats without hitting the cloud.\n  - **Change Tracking**: Automatically flag new or modified records to trigger the autonomous cloud sync.",
              "children": []
            }
          ]
        },
        {
          "level": 3,
          "title": "Phase 2: The Cloud Bridge (Connectivity)",
          "metadata": {
            "status": "todo",
            "type": "plan",
            "id": "product.saas.roadmap.phase2",
            "blocked_by": [
              "product.saas.roadmap.phase1"
            ],
            "estimate": "2w",
            "last_checked": "2026-01-23T21:44:23+01:00"
          },
          "content": "**Objective**: Establish a secure, simple pipe between the Local Node and the Cloud Agents.",
          "children": [
            {
              "level": 4,
              "title": "API Gateway & Auth",
              "metadata": {
                "status": "todo",
                "type": "task",
                "id": "product.saas.roadmap.phase2.api",
                "estimate": "1w",
                "last_checked": "2026-01-23T21:44:23+01:00"
              },
              "content": "- **Tech**: Google Cloud Run (Serverless) + FastAPI.\n- **Auth**: Simple API Key or Firebase Auth to link a specific Local Node to its Cloud resources.\n- **Endpoints**:\n  - `/agent/analyze`: Sends user query + relevant data snippets.\n  - `/agent/optimize`: Sends telemetry for RL processing.",
              "children": []
            },
            {
              "level": 4,
              "title": "Autonomous Data Sync Pipeline",
              "metadata": {
                "status": "todo",
                "type": "task",
                "id": "product.saas.roadmap.phase2.sync",
                "blocked_by": [
                  "product.saas.roadmap.phase2.api"
                ],
                "estimate": "1w",
                "last_checked": "2026-01-23T21:44:23+01:00"
              },
              "content": "- **Mechanism**: A background service in the Local App autonomously synchronizes the local warehouse with the Cloud Database.\n- **Efficiency**: Pushes delta updates (only changes) to Cloud Storage/BigQuery to minimize bandwidth.\n- **Policy**: Real-time sync for active telemetry; scheduled sync for large historical datasets.",
              "children": []
            }
          ]
        },
        {
          "level": 3,
          "title": "Phase 3: The Cloud Agents (Execution)",
          "metadata": {
            "status": "todo",
            "type": "plan",
            "id": "product.saas.roadmap.phase3",
            "blocked_by": [
              "product.saas.roadmap.phase2"
            ],
            "estimate": "6w",
            "last_checked": "2026-01-23T21:44:23+01:00"
          },
          "content": "**Objective**: The \"Brain\" that runs code and retrieves information.",
          "children": [
            {
              "level": 4,
              "title": "Agent Orchestrator",
              "metadata": {
                "status": "todo",
                "type": "task",
                "id": "product.saas.roadmap.phase3.orchestrator",
                "estimate": "2w",
                "last_checked": "2026-01-23T21:44:23+01:00"
              },
              "content": "- **Tech**: LangChain or Vertex AI Agent Builder.\n- **Role**:\n  - Receive user text.\n  - Decide: \"Do I need to write code?\" (Analyst) or \"Do I need to run an optimization?\" (Controller).\n  - Route the request.",
              "children": []
            },
            {
              "level": 4,
              "title": "The Analyst Agent (Code Interpreter)",
              "metadata": {
                "status": "todo",
                "type": "task",
                "id": "product.saas.roadmap.phase3.analyst",
                "blocked_by": [
                  "product.saas.roadmap.phase3.orchestrator"
                ],
                "estimate": "2w",
                "last_checked": "2026-01-23T21:44:23+01:00"
              },
              "content": "- **Sandbox**: Secure Python environment (e.g., E2B or restricted Docker container).\n- **Workflow**:\n  1. Agent writes Python code to analyze the uploaded data.\n  2. Executes code.\n  3. Captures output (Text + Image/JSON for charts).\n  4. Returns structured response to Local App.",
              "children": []
            },
            {
              "level": 4,
              "title": "The Controller Agent (Optimization)",
              "metadata": {
                "status": "todo",
                "type": "task",
                "id": "product.saas.roadmap.phase3.controller",
                "blocked_by": [
                  "product.saas.roadmap.phase3.analyst"
                ],
                "estimate": "2w",
                "last_checked": "2026-01-23T21:44:23+01:00"
              },
              "content": "- **Role**: Run the Recommender/Inventory logic (using Vertex AI Recommendations or custom RL).\n- **Input**: State vector from the Local App.\n- **Output**: Action (e.g., \"Reorder 50 units\") sent back to the Local App for user approval.",
              "children": []
            }
          ]
        }
      ]
    },
    {
      "level": 2,
      "title": "Security & Safety Checks",
      "metadata": {
        "status": "active",
        "type": "guideline",
        "id": "product.saas.security",
        "last_checked": "2026-01-23T13:47:07+01:00"
      },
      "content": "-   **Indirect Execution**: Clients only submit natural language, never code.\n-   **Repository Scoping**: Generated code can only import whitelisted libraries (`pandas`, `numpy`, `lib_analysis`). No `os` or `sys`.\n-   **Simulation Isolation**: User-provided logic runs in `gVisor` sandboxes.\n-   **Action Bounding**: Deterministic logic layer validates actions against safety constraints (e.g., `MAX_ORDER_LIMIT`) before execution.",
      "children": []
    },
    {
      "level": 2,
      "title": "Research Directions",
      "metadata": {
        "status": "active",
        "type": "plan",
        "id": "product.saas.research",
        "last_checked": "2026-01-23T13:47:07+01:00"
      },
      "content": "-   **MBRL (DreamerV3)**: Learning World Models from telemetry to simulate environments.\n-   **Safe RL**: Constrained MDPs (Lagrangian Relaxation) to ensure safety during exploration.\n-   **Reflexion**: Agents that analyze their own tracebacks to iteratively fix code.",
      "children": []
    }
  ]
}